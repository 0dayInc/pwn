#!/usr/bin/env ruby
# frozen_string_literal: true

require 'pwn'

opts = PWN::Env[:driver_opts]
PWN::Driver::Parser.new do |options|
  options.on('-pSTRING', '--payload=STRING', '<Required - String to Encode>') do |p|
    opts[:payload] = p
  end
end.parse!

payload = opts[:payload].to_s.scrub
puts payload.unpack('U*').map { |i| "\\u#{i.to_s(16).rjust(4, '0')}" }.join
